{% extends "base.html" %} {% load i18n %} {% block content %}

<style>

/*.draggable {
	width: 90px;
	height: 90px
	padding: 0.5em;
	 float: left;
	  margin: 0 10px 10px 0;
}
  */
#Equipamento {
	width: 100px;
	height: 100px;
	padding: 0.5em;
	float: left;
	margin: 0 10px 10px 0;
	/*left: 400px;
	top: 150px;*/
}

#Sensor1, #Sensor2 {
	width: 50px;
	height: 50px;
	padding: 0.5em;
	float: left;
	margin: 0 10px 10px 0;
}

#containment-wrapper {
	width: 80%;
	height: 80%;
	border: 2px solid #ccc;
	padding: 10px;
}

#containment-equipamento {
	width: 35%;
	height: 40%;
	border: 2px solid #ccc;
	padding: 10px;
}
</style>

<input type="button" class="btn btn-default" id="btnEquip" value="Listar Equipamentos">
</br>
</br>

<div id="containment-wrapper">


<!-- 
	{% for equipamento in equipamentos %} {% cycle rowvalue1 rowvalue2 %}
	<div id="containment-equipamento" class="draggable ui-widget-content">
		<div id="{{ equipamento.name }}" class="draggable ui-widget-content">
			<p>{{ equipamento.name }}</p>
		</div>
		{% for sensor in equipamento.sensor.all %}
		<div id="{{ sensor.name }}" class="draggable ui-widget-content">
			<p>sensor: {{ sensor.name }}</p>
		</div>
		{% endfor %}

		<div style="height: 5000px; width: 1px;"></div>
	</div>

	{% endfor %}
 -->
</div>


<script type="text/javascript">
	$(document).ready(function() {

		$("#btnEquip").click(
				
				function() {
					console.log('#someButton was clicked');
					$.ajax({
						type : "POST",
						url : "/home/equipamentos",
						//dataType : "json",
						//data: {};
						success : function(retorno) {
							
							console.log(retorno);
							
							
							$.each(retorno, function(i, item_equip) {
								
								$("#containment-wrapper").append(
										
										
										"<div style='width: 25%; height: 40%; border: 2px solid #ccc; padding: 10px;'"
										
										 + "id="+ item_equip.equipamento_id + " class='draggable ui-widget-content'>"
											+"<img id='theImg' src='/static/img/hardware.png' />"
												+ "<div id=" + item_equip.nomeEquipamento + " class='draggable ui-widget-content'>"
										    		+ "<p>"+ item_equip.nomeEquipamento +"</p>"
										    	+ "</div>"
									);
								
										$.each(item_equip.sensores, function(j, item_sensor) {
											//console.log(item_sensor.sensor_id);
											console.log("#"+ item_equip.equipamento_id);
											$("#"+ item_equip.equipamento_id).append(
															"<div id=" + item_sensor.nome_sensor + " class='draggable ui-widget-content'>"
													    	+ "<p>Sensor: "+ item_sensor.nome_sensor +"</p>"
													    	+ "</div>"
										+ "</div>"
									
										);
									});

								
								$("#containment-wrapper").append(
										+ "</div>"
								);
								
								$("#"+ item_equip.equipamento_id).draggable({
									
									containment : "#containment-wrapper",
									scroll : false
								});
								
							});
							
							
						},
						
					});
					
				});
			});
</script>
{% endblock %}



